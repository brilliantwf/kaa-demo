# EARS 需求文档
## 集团员工内部用餐点餐平台

### 文档说明
本文档采用EARS（Easy Approach to Requirements Syntax）模式编写，使用"当[事件]发生时，系统应[动作]以[响应]"的格式，确保需求清晰、可测试。

---

## 1. 菜单管理模块

### 1.1 菜品管理

**EARS-001**: 当系统管理员或食堂人员录入新菜品时，系统应保存菜品信息（名称、图片、分类、价格）以供后续使用。

**EARS-002**: 当系统管理员或食堂人员上传菜品图片时，系统应验证图片格式和大小，以确保图片可正常显示。

**EARS-003**: 当系统管理员或食堂人员将菜品设置为上架时，系统应更新菜品状态为"已上架"，以便该菜品可被选择用于菜单配置。

**EARS-004**: 当系统管理员或食堂人员将菜品设置为下架时，系统应更新菜品状态为"已下架"，以防止该菜品被选择用于新菜单。

**EARS-005**: 当系统管理员或食堂人员编辑已下架菜品时，系统应允许修改，以保持菜品信息的准确性。

**EARS-006**: 当系统管理员或食堂人员尝试删除已被使用的菜品时，系统应拒绝删除并提示错误，以保证数据完整性。

### 1.2 菜单管理

**EARS-007**: 当系统管理员或食堂人员创建每日菜单时，系统应要求选择食堂、日期、餐次（早餐/午餐/晚餐），以明确菜单适用范围。

**EARS-008**: 当系统管理员或食堂人员添加菜品到菜单时，系统应仅显示该食堂已上架的菜品，以确保菜品可用性。

**EARS-009**: 当系统管理员或食堂人员为菜单中的菜品设置数量时，系统应保存该数量作为可供点餐的库存，以控制供应量。

**EARS-010**: 当系统管理员或食堂人员保存菜单时，系统应验证同一食堂、同一日期、同一餐次不存在重复菜单，以避免冲突。

**EARS-011**: 当员工点餐导致某菜品数量减少时，系统应实时更新该菜品的可用数量，以反映实际库存。

---

## 2. 员工点餐模块

### 2.1 选择食堂

**EARS-012**: 当员工进入点餐页面时，系统应展示所有可用食堂列表，以供员工选择。

**EARS-013**: 当员工选择某个食堂时，系统应进入该食堂的点餐界面，以开始点餐流程。

### 2.2 当日菜单查看

**EARS-014**: 当员工进入点餐界面时，系统应展示当前选择食堂的当日菜单（按餐次分类），以便员工查看可点餐品。

**EARS-015**: 当系统展示菜单时，系统应显示每个菜品的名称、图片、剩余数量，以帮助员工做出选择。

### 2.3 即时点餐

**EARS-016**: 当员工在早餐7:30前提交早餐订单时，系统应接受并保存订单，以满足即时点餐需求。

**EARS-017**: 当员工在中餐11:00前提交午餐订单时，系统应接受并保存订单，以满足即时点餐需求。

**EARS-018**: 当员工在晚餐17:00前提交晚餐订单时，系统应接受并保存订单，以满足即时点餐需求。

**EARS-019**: 当员工在点餐截止时间后尝试提交订单时，系统应拒绝订单并提示"已超过点餐时间"，以强制执行时间限制。

**EARS-020**: 当员工尝试为同一餐次重复下单时，系统应拒绝订单并提示"该餐次已有订单"，以防止重复订单。

### 2.4 订单确认

**EARS-021**: 当员工选择菜品并确认数量后，系统应展示订单预览（包括菜品、数量、餐次、食堂），以供员工核对。

**EARS-022**: 当员工确认订单后，系统应创建订单记录（状态为"已下单"），不需要支付流程，以简化流程。

**EARS-023**: 当订单创建成功后，系统应扣减对应菜品的可用数量，以更新库存。

### 2.5 点餐日历视图

**EARS-024**: 当员工进入点餐首页时，系统应展示未来几天（包括明天及之后）的可预订餐次日历，以便员工规划。

**EARS-025**: 当员工选择日历中未来某天的餐次时，系统应展示该餐次的菜单，以支持预订功能。

**EARS-026**: 当员工预订未来餐次时，系统应仅允许预订明天或之后的餐次，以满足预订规则。

**EARS-027**: 当员工尝试预订当天餐次时，系统应按照即时点餐规则处理（受截止时间限制），以区分预订和即时点餐。

---

## 3. 订单管理模块

### 3.1 我的订单

**EARS-028**: 当员工查看"我的订单"时，系统应展示该员工的所有订单（包括历史订单），以供查询。

**EARS-029**: 当员工查看订单详情时，系统应显示订单的菜品、数量、餐次、食堂、状态、创建时间，以提供完整信息。

**EARS-030**: 当订单状态为"已下单"时，系统应在订单列表中标记为"已下单"，以表示订单待处理。

**EARS-031**: 当订单状态为"已取消"时，系统应在订单列表中标记为"已取消"，以表示订单已失效。

**EARS-032**: 当订单状态为"已完成"时，系统应在订单列表中标记为"已完成"，以表示订单已结束。

### 3.2 订单修改

**EARS-033**: 当员工在点餐截止时间前修改订单时，系统应允许修改菜品或数量，以提供灵活性。

**EARS-034**: 当员工修改订单菜品或数量后，系统应更新库存（退回原数量，扣减新数量），以保证库存准确。

**EARS-035**: 当员工在点餐截止时间后尝试修改订单时，系统应拒绝修改并提示"已超过修改时间"，以强制执行时间限制。

### 3.3 取消订单

**EARS-036**: 当员工在点餐截止时间前取消订单时，系统应将订单状态更新为"已取消"，以标记订单失效。

**EARS-037**: 当订单取消后，系统应退回订单中所有菜品的数量到可用库存，以释放资源。

**EARS-038**: 当员工在点餐截止时间后尝试取消订单时，系统应拒绝取消并提示"已超过取消时间"，以强制执行时间限制。

### 3.4 全部订单列表（食堂视图）

**EARS-039**: 当食堂人员查看订单列表时，系统应支持按餐次筛选，以便查看特定餐次的所有订单。

**EARS-040**: 当食堂人员查看订单列表时，系统应显示员工姓名、菜品、数量、订单状态，以提供订单详情。

### 3.5 餐次统计

**EARS-041**: 当系统管理员或食堂人员查看餐次统计时，系统应按菜品汇总订单数量，以辅助备餐。

**EARS-042**: 当系统管理员或食堂人员查看餐次统计时，系统应按员工汇总订单，以了解用餐人数。

**EARS-043**: 当系统管理员或食堂人员选择特定餐次时，系统应仅显示该餐次的统计数据，以提供针对性信息。

---

## 4. 后厨与备餐模块

### 4.1 备餐看板

**EARS-044**: 当食堂人员进入备餐看板时，系统应按菜品展示当前餐次的订单总数量，以辅助备餐安排。

**EARS-045**: 当备餐看板刷新时，系统应显示实时数据，以反映最新订单情况。

### 4.2 实时库存扣减

**EARS-046**: 当员工成功下单后，系统应立即扣减对应菜品的可用数量，以实时更新库存。

**EARS-047**: 当菜品库存为0时，系统应在点餐界面标记为"已售罄"，以防止继续点餐。

---

## 5. 评价与反馈模块

### 5.1 菜品评分

**EARS-048**: 当员工对已完成订单中的菜品进行评分时，系统应接受1-5分的评分，以收集反馈。

**EARS-049**: 当系统管理员查看菜品评分时，系统应展示每道菜品的平均分和评分次数，以评估菜品质量。

**EARS-050**: 当员工尝试对未完成订单的菜品评分时，系统应拒绝评分并提示"订单未完成"，以确保评价真实性。

### 5.2 意见反馈

**EARS-051**: 当员工提交意见反馈时，系统应保存反馈内容和提交时间，以记录员工建议。

**EARS-052**: 当系统管理员查看反馈列表时，系统应展示所有员工的反馈信息，以便管理决策。

---

## 6. 系统管理模块

### 6.1 食堂管理

**EARS-053**: 当系统管理员新增食堂时，系统应保存食堂名称、地址、联系电话，以建立食堂档案。

**EARS-054**: 当系统管理员编辑食堂信息时，系统应更新食堂资料，以保持信息准确。

**EARS-055**: 当系统管理员删除未被使用的食堂时，系统应允许删除，以清理无用数据。

**EARS-056**: 当系统管理员尝试删除已有菜单或订单的食堂时，系统应拒绝删除并提示错误，以保护数据完整性。

### 6.2 食堂人员管理

**EARS-057**: 当系统管理员新增食堂人员时，系统应保存人员信息并关联到指定食堂，以建立管理关系。

**EARS-058**: 当系统管理员编辑食堂人员信息时，系统应允许修改关联的食堂，以支持人员调整。

**EARS-059**: 当系统管理员删除食堂人员时，系统应解除人员与食堂的关联，以更新组织架构。

### 6.3 用户管理

**EARS-060**: 当系统管理员新增员工用户时，系统应保存用户基本信息（姓名、工号、部门、联系方式），以建立用户档案。

**EARS-061**: 当系统管理员编辑用户信息时，系统应更新用户资料，以保持数据准确。

**EARS-062**: 当系统管理员禁用用户时，系统应更新用户状态为"已禁用"，该用户无法登录系统，以控制访问权限。

**EARS-063**: 当系统管理员启用用户时，系统应更新用户状态为"已启用"，该用户可以正常登录，以恢复访问权限。

**EARS-064**: 当系统管理员设置员工所属部门时，系统应保存部门关联，以支持组织管理。

### 6.4 部门/组织架构管理

**EARS-065**: 当系统管理员创建部门时，系统应保存部门名称和上级部门，以构建组织架构。

**EARS-066**: 当系统管理员编辑部门信息时，系统应更新部门资料，以维护组织结构。

**EARS-067**: 当系统管理员删除无员工的部门时，系统应允许删除，以清理无用部门。

**EARS-068**: 当系统管理员尝试删除有员工的部门时，系统应拒绝删除并提示错误，以保护数据完整性。

---

## 7. 系统级需求

### 7.1 角色权限

**EARS-069**: 当用户登录系统时，系统应根据用户角色（员工/食堂人员/系统管理员）展示相应功能模块，以实现权限控制。

**EARS-070**: 当员工尝试访问管理功能时，系统应拒绝访问并提示"无权限"，以保护系统安全。

**EARS-071**: 当食堂人员访问菜单管理时，系统应仅允许管理其所属食堂的菜单，以限制操作范围。

### 7.2 多食堂支持

**EARS-072**: 当企业有多个办公地点时，系统应支持创建多个食堂，以满足多地点管理需求。

**EARS-073**: 当食堂人员管理菜单时，系统应仅允许管理其负责的食堂，以实现分权管理。

### 7.3 时间限制

**EARS-074**: 当系统判断点餐截止时间时，系统应使用服务器时间作为标准，以确保时间一致性。

**EARS-075**: 当员工尝试预订当天餐次时，系统应检查当前时间是否超过截止时间，以强制执行时间规则。

---

## 附录

### 餐次时间定义
- **早餐**: 07:30 为点餐截止时间
- **午餐**: 11:00 为点餐截止时间
- **晚餐**: 17:00 为点餐截止时间

### 订单状态定义
- **已下单**: 订单已创建，等待用餐
- **已取消**: 订单已被员工取消
- **已完成**: 订单已完成（用餐时间已过）

### 角色定义
- **员工**: 可以点餐、查看订单、评价、反馈
- **食堂人员**: 可以管理菜品、菜单、查看订单、统计
- **系统管理员**: 拥有所有权限，包括系统配置和用户管理
