# INCOSE 质量规范需求文档
## 集团员工内部用餐点餐平台

### 文档说明
本文档遵循INCOSE（国际系统工程协会）质量规范，确保需求的：
- **完整性（Completeness）**: 覆盖所有必要功能和约束
- **一致性（Consistency）**: 需求之间无矛盾
- **可验证性（Verifiability）**: 可通过测试验证
- **可追溯性（Traceability）**: 需求可追溯到业务目标

---

## 1. 需求概述

### 1.1 系统目标
为企业集团提供统一的员工用餐点餐平台，支持多食堂管理、在线点餐、菜单管理、订单管理等功能，提升用餐服务效率和员工满意度。

### 1.2 利益相关者
- **员工**: 系统的主要使用者，通过H5页面进行点餐
- **食堂人员**: 管理菜品和菜单，查看订单和统计
- **系统管理员**: 负责系统配置、用户管理、权限管理
- **企业管理层**: 关注系统运行效率和员工满意度

---

## 2. 功能需求

### 2.1 菜单管理模块

#### 2.1.1 菜品管理
**需求ID**: FR-001  
**需求描述**: 系统应提供菜品管理功能，支持菜品的增删改查和上下架操作  
**优先级**: 高  
**追溯性**: 业务目标 - 提供灵活的菜品管理能力  
**验证方法**: 功能测试 - 验证菜品CRUD操作和状态变更  
**前置条件**: 用户已登录且具有食堂人员或系统管理员权限  
**后置条件**: 菜品信息已保存至数据库  
**输入**: 菜品名称、分类、价格、图片、状态  
**输出**: 操作成功/失败提示  
**约束条件**: 
- 菜品名称长度不超过100字符
- 图片格式支持JPG、PNG，大小不超过5MB
- 菜品分类必须是预定义的类别

**需求ID**: FR-002  
**需求描述**: 系统应支持菜品上架和下架操作，已下架菜品不可用于新菜单配置  
**优先级**: 高  
**追溯性**: FR-001  
**验证方法**: 功能测试 - 验证上下架状态变更和菜单配置限制  
**前置条件**: 菜品已存在  
**后置条件**: 菜品状态已更新  
**约束条件**: 已下架菜品仍可在历史菜单中查看

#### 2.1.2 菜单管理
**需求ID**: FR-003  
**需求描述**: 系统应支持按食堂、日期、餐次配置每日菜单  
**优先级**: 高  
**追溯性**: 业务目标 - 支持灵活的菜单配置  
**验证方法**: 功能测试 - 验证菜单创建和配置  
**前置条件**: 食堂已创建，至少有一个已上架菜品  
**后置条件**: 菜单已保存并可被员工查看  
**输入**: 食堂ID、日期、餐次、菜品列表及数量  
**输出**: 菜单创建成功/失败提示  
**约束条件**: 
- 同一食堂、日期、餐次只能有一个菜单
- 菜品数量必须大于0

**需求ID**: FR-004  
**需求描述**: 系统应实时更新菜品可用数量，当员工下单后自动扣减库存  
**优先级**: 高  
**追溯性**: FR-003  
**验证方法**: 集成测试 - 验证下单后库存变化  
**前置条件**: 菜单已配置  
**后置条件**: 库存数量已更新  
**约束条件**: 库存不能为负数

### 2.2 员工点餐模块

#### 2.2.1 选择食堂
**需求ID**: FR-005  
**需求描述**: 系统应展示所有可用食堂供员工选择  
**优先级**: 高  
**追溯性**: 业务目标 - 支持多食堂管理  
**验证方法**: 功能测试 - 验证食堂列表展示  
**前置条件**: 至少有一个食堂已创建  
**后置条件**: 员工进入所选食堂的点餐界面  

#### 2.2.2 当日菜单查看
**需求ID**: FR-006  
**需求描述**: 系统应展示选定食堂的当日菜单，包括菜品名称、图片、剩余数量  
**优先级**: 高  
**追溯性**: FR-003  
**验证方法**: 功能测试 - 验证菜单展示内容  
**前置条件**: 食堂已配置当日菜单  
**后置条件**: 员工可查看菜单详情  
**约束条件**: 剩余数量为0的菜品应标记为"已售罄"

#### 2.2.3 即时点餐
**需求ID**: FR-007  
**需求描述**: 系统应支持员工在规定时间内进行即时点餐  
**优先级**: 高  
**追溯性**: 业务目标 - 提供便捷的点餐服务  
**验证方法**: 功能测试 - 验证时间限制和订单创建  
**前置条件**: 员工已登录，在点餐截止时间前  
**后置条件**: 订单已创建，库存已扣减  
**输入**: 菜品选择、数量  
**输出**: 订单确认信息  
**约束条件**: 
- 早餐截止时间: 07:30
- 午餐截止时间: 11:00
- 晚餐截止时间: 17:00
- 每个餐次每个员工只能有一个有效订单

**需求ID**: FR-008  
**需求描述**: 系统应拒绝超过截止时间的点餐请求  
**优先级**: 高  
**追溯性**: FR-007  
**验证方法**: 功能测试 - 验证时间验证逻辑  
**前置条件**: 当前时间已超过截止时间  
**后置条件**: 订单未创建，提示错误信息  

#### 2.2.4 订单确认
**需求ID**: FR-009  
**需求描述**: 系统应在员工下单前展示订单预览，确认后创建订单  
**优先级**: 高  
**追溯性**: FR-007  
**验证方法**: 功能测试 - 验证订单预览和确认流程  
**前置条件**: 员工已选择菜品和数量  
**后置条件**: 订单已创建，状态为"已下单"  
**约束条件**: 无需支付流程

#### 2.2.5 点餐日历视图
**需求ID**: FR-010  
**需求描述**: 系统应展示未来几天的可预订餐次日历，支持预订功能  
**优先级**: 中  
**追溯性**: 业务目标 - 提升用户体验  
**验证方法**: 功能测试 - 验证日历展示和预订功能  
**前置条件**: 未来日期已配置菜单  
**后置条件**: 员工可预订未来餐次  
**约束条件**: 只能预订明天或之后的餐次

### 2.3 订单管理模块

#### 2.3.1 我的订单
**需求ID**: FR-011  
**需求描述**: 系统应提供"我的订单"功能，展示员工的所有订单  
**优先级**: 高  
**追溯性**: 业务目标 - 提供订单查询能力  
**验证方法**: 功能测试 - 验证订单列表展示  
**前置条件**: 员工已登录  
**后置条件**: 展示订单列表  
**输出**: 订单列表（菜品、数量、餐次、食堂、状态、时间）  

**需求ID**: FR-012  
**需求描述**: 系统应支持三种订单状态：已下单、已取消、已完成  
**优先级**: 高  
**追溯性**: FR-011  
**验证方法**: 功能测试 - 验证状态流转  
**约束条件**: 状态流转规则明确，不可逆向

#### 2.3.2 订单修改
**需求ID**: FR-013  
**需求描述**: 系统应允许员工在截止时间前修改订单  
**优先级**: 中  
**追溯性**: 业务目标 - 提供灵活性  
**验证方法**: 功能测试 - 验证修改功能和时间限制  
**前置条件**: 订单状态为"已下单"，当前时间在截止时间前  
**后置条件**: 订单已更新，库存已调整  
**约束条件**: 超过截止时间后不可修改

#### 2.3.3 取消订单
**需求ID**: FR-014  
**需求描述**: 系统应允许员工在截止时间前取消订单  
**优先级**: 高  
**追溯性**: 业务目标 - 提供灵活性  
**验证方法**: 功能测试 - 验证取消功能和库存退回  
**前置条件**: 订单状态为"已下单"，当前时间在截止时间前  
**后置条件**: 订单状态更新为"已取消"，库存已退回  
**约束条件**: 超过截止时间后不可取消

#### 2.3.4 全部订单列表
**需求ID**: FR-015  
**需求描述**: 系统应为食堂人员提供按餐次查看所有订单的功能  
**优先级**: 高  
**追溯性**: 业务目标 - 支持订单管理  
**验证方法**: 功能测试 - 验证订单列表和筛选  
**前置条件**: 食堂人员已登录  
**后置条件**: 展示订单列表  
**约束条件**: 食堂人员只能查看其负责食堂的订单

#### 2.3.5 餐次统计
**需求ID**: FR-016  
**需求描述**: 系统应提供餐次统计功能，按菜品、数量、员工汇总  
**优先级**: 高  
**追溯性**: 业务目标 - 辅助备餐决策  
**验证方法**: 功能测试 - 验证统计数据准确性  
**前置条件**: 存在订单数据  
**后置条件**: 展示统计报表  
**输出**: 菜品汇总、员工汇总、数量统计  

### 2.4 后厨与备餐模块

#### 2.4.1 备餐看板
**需求ID**: FR-017  
**需求描述**: 系统应提供备餐看板，按菜品展示订单数量  
**优先级**: 中  
**追溯性**: FR-016  
**验证方法**: 功能测试 - 验证看板展示  
**前置条件**: 存在订单数据  
**后置条件**: 展示实时看板  
**约束条件**: 数据应实时刷新

#### 2.4.2 实时库存扣减
**需求ID**: FR-018  
**需求描述**: 系统应在下单时立即扣减库存  
**优先级**: 高  
**追溯性**: FR-004  
**验证方法**: 集成测试 - 验证库存实时性  
**前置条件**: 订单已创建  
**后置条件**: 库存已扣减  
**约束条件**: 使用数据库事务保证原子性

### 2.5 评价与反馈模块

#### 2.5.1 菜品评分
**需求ID**: FR-019  
**需求描述**: 系统应支持员工对已完成订单的菜品进行1-5分评分  
**优先级**: 低  
**追溯性**: 业务目标 - 收集反馈改进服务  
**验证方法**: 功能测试 - 验证评分功能  
**前置条件**: 订单状态为"已完成"  
**后置条件**: 评分已保存  
**输入**: 菜品ID、评分（1-5）  
**约束条件**: 每个菜品每个订单只能评分一次

**需求ID**: FR-020  
**需求描述**: 系统应为管理员提供菜品评分统计功能  
**优先级**: 低  
**追溯性**: FR-019  
**验证方法**: 功能测试 - 验证统计展示  
**输出**: 菜品平均分、评分次数  

#### 2.5.2 意见反馈
**需求ID**: FR-021  
**需求描述**: 系统应支持员工提交意见反馈  
**优先级**: 低  
**追溯性**: 业务目标 - 收集改进建议  
**验证方法**: 功能测试 - 验证反馈提交和查看  
**前置条件**: 员工已登录  
**后置条件**: 反馈已保存  
**输入**: 反馈内容  

**需求ID**: FR-022  
**需求描述**: 系统应为管理员提供查看所有反馈的功能  
**优先级**: 低  
**追溯性**: FR-021  
**验证方法**: 功能测试 - 验证反馈列表展示  

### 2.6 系统管理模块

#### 2.6.1 食堂管理
**需求ID**: FR-023  
**需求描述**: 系统应支持食堂的增删改查操作  
**优先级**: 高  
**追溯性**: 业务目标 - 支持多食堂管理  
**验证方法**: 功能测试 - 验证CRUD操作  
**前置条件**: 用户具有系统管理员权限  
**后置条件**: 食堂信息已保存  
**输入**: 食堂名称、地址、联系电话  
**约束条件**: 
- 食堂名称不能重复
- 有关联数据的食堂不能删除

#### 2.6.2 食堂人员管理
**需求ID**: FR-024  
**需求描述**: 系统应支持食堂人员的增删改查和食堂关联  
**优先级**: 高  
**追溯性**: 业务目标 - 支持权限管理  
**验证方法**: 功能测试 - 验证人员管理  
**前置条件**: 用户具有系统管理员权限  
**后置条件**: 人员信息已保存  
**输入**: 人员信息、关联食堂ID  

#### 2.6.3 用户管理
**需求ID**: FR-025  
**需求描述**: 系统应支持用户的增删改查、启用禁用操作  
**优先级**: 高  
**追溯性**: 业务目标 - 用户管理  
**验证方法**: 功能测试 - 验证用户管理  
**前置条件**: 用户具有系统管理员权限  
**后置条件**: 用户信息已保存  
**输入**: 姓名、工号、部门、联系方式、状态  
**约束条件**: 工号唯一

#### 2.6.4 部门管理
**需求ID**: FR-026  
**需求描述**: 系统应支持部门的增删改查和组织架构管理  
**优先级**: 中  
**追溯性**: FR-025  
**验证方法**: 功能测试 - 验证部门管理  
**前置条件**: 用户具有系统管理员权限  
**后置条件**: 部门信息已保存  
**输入**: 部门名称、上级部门  
**约束条件**: 有员工的部门不能删除

---

## 3. 非功能需求

### 3.1 性能需求
**需求ID**: NFR-001  
**需求描述**: 系统应支持至少500个并发用户同时访问  
**优先级**: 高  
**验证方法**: 性能测试 - 模拟并发访问  
**衡量标准**: 
- 页面响应时间 < 2秒
- API响应时间 < 500毫秒
- 数据库查询时间 < 200毫秒

**需求ID**: NFR-002  
**需求描述**: 系统应保证高峰时段的稳定性  
**优先级**: 高  
**验证方法**: 压力测试  
**衡量标准**: 在高峰时段（11:00-11:30, 17:00-17:30）错误率 < 0.1%

### 3.2 可用性需求
**需求ID**: NFR-003  
**需求描述**: 系统年可用性应达到99%以上  
**优先级**: 中  
**验证方法**: 运维监控  
**衡量标准**: 年度停机时间 < 3.65天

### 3.3 安全性需求
**需求ID**: NFR-004  
**需求描述**: 系统应实施用户认证和授权机制  
**优先级**: 高  
**验证方法**: 安全测试  
**衡量标准**: 
- 所有API需要认证
- 基于角色的访问控制（RBAC）
- 密码加密存储

**需求ID**: NFR-005  
**需求描述**: 系统应防止SQL注入和XSS攻击  
**优先级**: 高  
**验证方法**: 安全扫描和渗透测试  
**衡量标准**: 通过OWASP Top 10安全检查

### 3.4 可维护性需求
**需求ID**: NFR-006  
**需求描述**: 代码应遵循统一的编码规范  
**优先级**: 中  
**验证方法**: 代码审查  
**衡量标准**: 
- 代码使用英文
- 文档和注释使用中文
- 遵循PEP 8规范（Python）

**需求ID**: NFR-007  
**需求描述**: 系统应提供详细的日志记录  
**优先级**: 中  
**验证方法**: 日志审查  
**衡量标准**: 
- 记录所有错误和异常
- 记录关键操作（登录、下单、修改）
- 日志包含时间戳、用户ID、操作类型

### 3.5 可扩展性需求
**需求ID**: NFR-008  
**需求描述**: 系统架构应支持横向扩展  
**优先级**: 中  
**验证方法**: 架构审查  
**衡量标准**: 
- 无状态服务设计
- 支持负载均衡
- 数据库支持读写分离

### 3.6 兼容性需求
**需求ID**: NFR-009  
**需求描述**: 员工端H5页面应兼容主流移动浏览器  
**优先级**: 高  
**验证方法**: 兼容性测试  
**衡量标准**: 支持iOS Safari、Android Chrome、微信内置浏览器

**需求ID**: NFR-010  
**需求描述**: 管理端应兼容主流PC浏览器  
**优先级**: 高  
**验证方法**: 兼容性测试  
**衡量标准**: 支持Chrome、Firefox、Edge最新版本

### 3.7 数据完整性需求
**需求ID**: NFR-011  
**需求描述**: 系统应使用事务保证数据一致性  
**优先级**: 高  
**验证方法**: 集成测试  
**衡量标准**: 
- 下单操作使用事务（订单创建+库存扣减）
- 取消订单使用事务（状态更新+库存退回）
- 修改订单使用事务（订单更新+库存调整）

### 3.8 部署需求
**需求ID**: NFR-012  
**需求描述**: 系统应支持Conda虚拟环境部署  
**优先级**: 高  
**验证方法**: 部署测试  
**衡量标准**: 
- 提供environment.yml配置
- 提供一键启动和停止脚本
- 提供完整的部署文档

---

## 4. 约束条件

### 4.1 技术约束
**约束ID**: CON-001  
**描述**: 必须使用Python 3.12版本  
**理由**: 统一技术栈，确保兼容性  

**约束ID**: CON-002  
**描述**: 必须使用SQLite数据库，使用原生SQL操作，不使用ORM  
**理由**: 简化部署，避免ORM学习成本  

**约束ID**: CON-003  
**描述**: 不使用缓存  
**理由**: 简化架构，降低复杂度  

**约束ID**: CON-004  
**描述**: 使用Conda虚拟环境（ordering-system）  
**理由**: 隔离环境，避免依赖冲突  

### 4.2 业务约束
**约束ID**: CON-005  
**描述**: 不需要取餐核销功能  
**理由**: 简化流程，降低实施成本  

**约束ID**: CON-006  
**描述**: 无支付流程  
**理由**: 企业内部免费用餐  

**约束ID**: CON-007  
**描述**: 预留企业微信集成字段，本期不实现集成  
**理由**: 为未来扩展做准备  

### 4.3 界面约束
**约束ID**: CON-008  
**描述**: 员工端必须使用H5页面，适配移动端  
**理由**: 员工使用手机访问  

**约束ID**: CON-009  
**描述**: 管理端必须使用PC浏览器访问  
**理由**: 管理功能需要大屏幕操作  

---

## 5. 需求追溯矩阵

| 需求ID | 需求描述 | 业务目标 | 验证方法 | 优先级 |
|--------|----------|----------|----------|--------|
| FR-001 | 菜品管理 | 灵活管理 | 功能测试 | 高 |
| FR-003 | 菜单管理 | 灵活配置 | 功能测试 | 高 |
| FR-007 | 即时点餐 | 便捷服务 | 功能测试 | 高 |
| FR-011 | 我的订单 | 查询能力 | 功能测试 | 高 |
| FR-013 | 订单修改 | 提供灵活性 | 功能测试 | 中 |
| FR-016 | 餐次统计 | 辅助决策 | 功能测试 | 高 |
| FR-023 | 食堂管理 | 多食堂支持 | 功能测试 | 高 |
| NFR-001 | 性能要求 | 用户体验 | 性能测试 | 高 |
| NFR-004 | 安全要求 | 数据安全 | 安全测试 | 高 |

---

## 6. 验收标准

### 6.1 功能验收
- ✅ 所有功能需求已实现并通过测试
- ✅ 用户角色和权限控制正确
- ✅ 时间限制逻辑正确
- ✅ 库存扣减和退回逻辑正确
- ✅ 订单状态流转正确

### 6.2 性能验收
- ✅ 并发测试通过（500用户）
- ✅ 响应时间符合要求
- ✅ 高峰时段稳定性测试通过

### 6.3 安全验收
- ✅ 通过安全扫描
- ✅ 认证授权机制正确
- ✅ 无常见安全漏洞

### 6.4 文档验收
- ✅ README.md完整
- ✅ API文档完整
- ✅ 部署文档完整
- ✅ 用户手册完整

### 6.5 交付物验收
- ✅ 源代码完整
- ✅ 数据库初始化脚本
- ✅ 一键启动/停止脚本
- ✅ Conda环境配置文件
- ✅ 所有文档和注释使用中文
- ✅ 所有代码使用英文

---

## 7. 质量保证

### 7.1 完整性检查
- ✅ 所有CSV中的功能已覆盖
- ✅ 所有角色的功能已实现
- ✅ 所有业务流程已实现

### 7.2 一致性检查
- ✅ 需求之间无矛盾
- ✅ 数据模型一致
- ✅ 接口定义一致

### 7.3 可验证性检查
- ✅ 所有需求可测试
- ✅ 验证方法明确
- ✅ 验收标准清晰

### 7.4 可追溯性检查
- ✅ 需求可追溯到业务目标
- ✅ 测试用例可追溯到需求
- ✅ 代码可追溯到需求

---

## 附录

### A. 术语表
- **食堂**: 企业内部餐厅
- **餐次**: 早餐、午餐、晚餐
- **菜品**: 食堂提供的菜肴
- **菜单**: 某食堂某日某餐次的菜品清单
- **订单**: 员工的点餐记录
- **库存**: 菜品的可用数量

### B. 参考文档
- INCOSE Systems Engineering Handbook
- ISO/IEC/IEEE 29148:2018 Systems and software engineering
- CSV功能需求文件

### C. 变更历史
| 版本 | 日期 | 变更内容 | 作者 |
|------|------|----------|------|
| 1.0 | 2025-01-01 | 初始版本 | 系统分析师 |
